@model AfReparosAutomotivos.Models.OrcamentosViewModel

@{
    ViewData["Title"] = "Cadastrar Orçamento";
    var customHeaderColor = "#3b2e1a"; 
}

<div class="container mt-5">
    <div class="card shadow-lg rounded-4 border-0">
        <div class="card-header text-white text-center rounded-top-4" style="background-color: @customHeaderColor">
            <h3 class="mb-0">Cadastrar Orçamento</h3>
        </div>

        <div class="card-body p-4">
            <form asp-action="Create">
                <div asp-validation-summary="ModelOnly" class="text-danger mb-4"></div>

                <div class="row g-4">
                    <fieldset class="border p-3 rounded-3 mb-4">
                        <legend class="float-none w-auto px-2 fs-6 fw-bold text-muted">Dados do Cliente</legend>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label asp-for="nome" class="form-label fw-semibold">Nome do Cliente</label>
                                <input asp-for="nome" type="text" class="form-control" required />
                                <span asp-validation-for="nome" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="DocumentoCli" class="form-label fw-semibold">Documento do Cliente</label>
                                <input asp-for="DocumentoCli" type="text" class="form-control" 
                                    placeholder="Apenas números (11 ou 14 dígitos)" 
                                    
                                    oninput="this.value = this.value.replace(/[^0-9]/g,'')"
                                    maxlength="14">
                                <span asp-validation-for="DocumentoCli" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="TelefoneCli" class="form-label fw-semibold">Telefone do Cliente</label>
                                <input asp-for="TelefoneCli" type="text" class="form-control" maxlength="11" 
                                    placeholder="Apenas números (Ex: 11999998888)"
                                    required />
                                <span asp-validation-for="TelefoneCli" class="text-danger"></span>
                            </div> 
                            <div class="col-md-6">
                                <label asp-for="EnderecoCli" class="form-label fw-semibold">Endereço do Cliente</label>
                                <input asp-for="EnderecoCli" type="text" class="form-control"
                                    placeholder="Ex: Rua João, número 3, São José do Rio Preto - SP" />
                                <span asp-validation-for="EnderecoCli" class="text-danger"></span>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="border p-3 rounded-3 mb-4">
                        <legend class="float-none w-auto px-2 fs-6 fw-bold text-muted">Dados do Veículo</legend>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label asp-for="Placa" class="form-label fw-semibold">Placa do Veículo</label>
                                <input asp-for="Placa" type="text" class="form-control" placeholder="Ex: ABC1234" />
                                <span asp-validation-for="Placa" class="text-danger"></span>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="Marca" class="form-label fw-semibold">Marca</label>
                                <input asp-for="Marca" type="text" class="form-control" placeholder="Ex: Fiat" />
                                <span asp-validation-for="Marca" class="text-danger"></span>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="Modelo" class="form-label fw-semibold">Modelo</label>
                                <input asp-for="Modelo" type="text" class="form-control" placeholder="Ex: Palio" />
                                <span asp-validation-for="Modelo" class="text-danger"></span>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="border p-3 rounded-3">
                        <legend class="float-none w-auto px-2 fs-6 fw-bold text-muted">Detalhes do Orçamento</legend>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label asp-for="idFuncionario" class="form-label fw-semibold">ID do Funcionário</label>
                                <input asp-for="idFuncionario" type="number" class="form-control" placeholder="Ex: 12" required>
                                <span asp-validation-for="idFuncionario" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="dataCriacao" class="form-label fw-semibold">Data de Criação</label>
                                <input asp-for="dataCriacao" type="datetime-local" class="form-control" required 
                                    value="@DateTime.Now.ToString("yyyy-MM-ddTHH:mm")">
                                <span asp-validation-for="dataCriacao" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="dataEntrega" class="form-label fw-semibold">Data de Entrega</label>
                                <input asp-for="dataEntrega" type="date" class="form-control">
                                <span asp-validation-for="dataEntrega" class="text-danger"></span>
                            </div>
                            <!-- NOVO CAMPO SELECT PARA SERVIÇOS -->
                            <div class="col-md-6">
                                <label asp-for="IdServico" class="form-label fw-semibold">Selecione o Serviço</label>
                                <select asp-for="IdServico" 
                                        class="form-control" 
                                        asp-items="@Model.ServicosDisponiveis" 
                                        required>
                                    <option value="">-- Selecione um Serviço --</option>
                                </select>
                                <span asp-validation-for="IdServico" class="text-danger"></span>
                            </div>
                            <!-- FIM DO NOVO CAMPO SELECT -->
                            <div class="col-md-6">
                                <label asp-for="status" class="form-label fw-semibold">Status</label>
                                <select asp-for="status" class="form-control" required>
                                    <option value="1">1 - Em Aberto</option>
                                    <option value="2">2 - Pago</option>
                                    <option value="3">3 - Cancelado</option>
                                </select>
                                <span asp-validation-for="status" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="total" class="form-label fw-semibold">Valor Total</label>
                                <div class="input-group">
                                    <span class="input-group-text">R$</span>
                                    <input asp-for="total" type="text" class="form-control" placeholder="Ex: 250,00"
                                        asp-format="{0:N2}" step="0.01" inputmode="decimal" required>
                                </div>
                                <span asp-validation-for="total" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="formaPagamento" class="form-label fw-semibold">Forma de Pagamento</label>
                                <input asp-for="formaPagamento" type="text" class="form-control"
                                    placeholder="Cartão, PIX, ..." required>
                                <span asp-validation-for="formaPagamento" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="parcelas" class="form-label fw-semibold">Parcelas</label>
                                <input asp-for="parcelas" type="number" class="form-control" min="1" step="1" required>
                                <span asp-validation-for="parcelas" class="text-danger"></span>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="d-flex justify-content-end gap-3 mt-4">
                    <a asp-action="Index" class="btn btn-outline-secondary px-4">Voltar</a>
                    <button type="submit" class="btn-login">Criar</button>
                </div>
            </form>
        </div>
    </div>
</div>